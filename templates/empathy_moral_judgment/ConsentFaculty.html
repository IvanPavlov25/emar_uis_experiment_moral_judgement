{% extends 'base.html' %}
{% block content %}
<h3>Consentimiento informado</h3>
<p>Propósito: estudiar decisiones económicas y juicios morales. Los datos son anónimos y no personales. Puede retirarse en cualquier momento cerrando esta página. Contacto: grupo EMAR – UIS.</p>
<form method="post">{% csrf_token %}
  <div class="form-check my-3">
    <input class="form-check-input" type="checkbox" id="id_consent">
    <label class="form-check-label" for="id_consent">Acepto participar.</label>
  </div>
  <div class="mb-3">
    <label for="id_faculty" class="form-label">Facultad</label>
    <select name="faculty" id="id_faculty" class="form-select" required>
      <option value="">Seleccione...</option>
      {% for f in faculties %}
        <option value="{{ f }}">{{ f }}</option>
      {% endfor %}
    </select>
  </div>
  <input type="hidden" name="consent" id="id_hidden_consent">
  <button type="submit" class="btn btn-primary btn-lg" id="btn_continue" disabled>Continuar</button>
</form>
<script>
const consentBox = document.getElementById('id_consent');
const facultySelect = document.getElementById('id_faculty');
const btn = document.getElementById('btn_continue');
const hiddenConsent = document.getElementById('id_hidden_consent');
function toggle(){
  btn.disabled = !(consentBox.checked && facultySelect.value);
  hiddenConsent.value = consentBox.checked ? 'True' : '';
}
consentBox.addEventListener('change', toggle);
facultySelect.addEventListener('change', toggle);
</script>
{% endblock %}
